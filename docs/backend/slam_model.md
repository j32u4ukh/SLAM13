# SLAM 模型

『SLAM 模型』由『運動方程式』和『觀測方程式』組成：

![SLAM 模型](../image/slam_model.png)

由於方程式都會受到雜訊影響，因此應假設『位姿 x』和『路標 y』服從某種機率分佈的隨機變數，而非明確的數值。

則問題變成：『當擁有 輸入資料 u 和 觀測資料 z 時，如何確定狀態 x, y 的條件機率分佈？』

P(x, y| z, u) 稱為『後驗機率』，可利用貝氏法則得到

![P(z, u | x, y) * P(x, y) / P(z, u)](../image/pxyzu_bayes.png)

分母部份 P(z, u) 與待估計的狀態 x, y 無關，因此可忽略。分解後的左式稱為『**似然(Likehood)**』，右式稱為『**先驗(Prior)**』。

直接求後驗分佈是困難的，但『求一個狀態最佳估計，使得該狀態下後驗機率最大化』是可行的：

```
MAP(x, y) = argmax P(x, y| z, u) = argmax P(z, u | x, y) * P(x, y)
```

上式告訴我們，求解『最大後驗機率(Maximum-a-Posterior, MAP)』相等於『最大化 似然和先驗的乘積』。

若缺乏『先驗(相機位姿或路標大概在哪裡)』，則可求解『最大似然估計(Maximize Likelihood Estimation, MLE)』：

```
MLE(x, y) = argmax P(z, u | x, y)
```

似然：『在現在的位姿下，可能產生怎樣的觀測資料。』
最大似然估計：『在怎樣的狀態下，最可能產生現在觀測到的資料。』

## 漸進式 狀態估計

已知『批次狀態估計問題』可以轉化為『最大似然估計問題』，並使用『最小平方法』進行求解。

考慮第 k 時刻的情況，用過去 0 到 k 中的資料來估計現在的狀態分佈：

根據貝氏法則，第一項為**似然**，第二項為**先驗**：

先驗部份，狀態 Xk 是以過去所有為基礎的狀態，至少會受到 X_k-1 影響，於是以 X_k-1 時刻為條件機率展開：

由於上式還沒有實際的機率分佈形式，所以無法實際操作它。可以有下列 2 種方法：

1. 假設馬卡夫性，使用**擴充卡爾曼濾波(EKF)**為代表的濾波器方法。
2. 考慮 k 時刻和過去**所有**狀態的關係的**非線性最佳化**為主體的最佳化框架。